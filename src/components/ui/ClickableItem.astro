---
import { Icon } from 'astro-icon/components';
import { twMerge } from 'tailwind-merge';
import Button from './Button.astro';
import { getPermalink } from '~/utils/permalinks';
import type { Item } from '~/types';

interface Props {
  item: Item;
  defaultIcon?: string;
  classes?: Record<string, string>;
}

const { item, defaultIcon, classes = {} } = Astro.props;

const { title = '', description = '', icon = '', callToAction, classes: itemClasses = {}, link = '' } = item;

const {
  panel: panelClass = '',
  title: titleClass = '',
  description: descriptionClass = '',
  icon: defaultIconClass = 'text-primary',
} = classes;
---

<a
  class={twMerge(
    'relative flex flex-col intersect-once intersect-quarter intersect-no-queue ',
    panelClass,
    itemClasses?.panel,
    link && 'cursor-pointer hover:border hover:border-slate-500'
  )}
  {...link && { href: getPermalink(link) }}
>
  {
    (icon || defaultIcon) && (
      <Icon name={icon || defaultIcon} class={twMerge('mb-2 w-10 h-10', defaultIconClass, itemClasses?.icon)} />
    )
  }
  <div class={twMerge('text-xl font-bold', titleClass, itemClasses?.title)}>{title}</div>
  {
    description && (
      <p class={twMerge('text-muted mt-2', descriptionClass, itemClasses?.description)} set:html={description} />
    )
  }
  {
    callToAction && (
      <div class="mt-2">
        <Button {...callToAction} />
      </div>
    )
  }
</a>
